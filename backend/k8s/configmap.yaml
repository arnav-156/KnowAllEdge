# =============================================================================
# Kubernetes ConfigMap
# Non-sensitive configuration for backend pods
# =============================================================================

apiVersion: v1
kind: ConfigMap
metadata:
  name: KNOWALLEDGE-config
  namespace: default
  labels:
    app: KNOWALLEDGE
data:
  # Flask configuration
  FLASK_ENV: "production"
  FLASK_APP: "main.py"
  
  # Redis configuration
  REDIS_HOST: "redis"
  REDIS_PORT: "6379"
  REDIS_ENABLED: "true"
  REDIS_DB: "0"
  REDIS_MAX_CONNECTIONS: "50"
  
  # Quota configuration
  QUOTA_RPM: "15"
  QUOTA_RPD: "1500"
  QUOTA_TPM: "1000000"
  QUOTA_TPD: "50000000"
  QUOTA_SAFETY_MARGIN: "0.8"
  QUOTA_ENABLE_FALLBACK: "true"
  QUOTA_FALLBACK_CACHE_TTL: "3600"
  QUOTA_MAX_QUEUE_SIZE: "100"
  
  # Rate limiting configuration
  RATE_LIMIT_ENABLED: "true"
  RATE_LIMIT_USER_PER_MINUTE: "10"
  RATE_LIMIT_USER_PER_HOUR: "100"
  RATE_LIMIT_USER_PER_DAY: "500"
  RATE_LIMIT_IP_PER_MINUTE: "20"
  RATE_LIMIT_IP_PER_HOUR: "200"
  RATE_LIMIT_GLOBAL_PER_MINUTE: "100"
  RATE_LIMIT_GLOBAL_PER_HOUR: "1000"
  
  # Caching configuration
  CACHE_BROWSER_TTL: "300"
  CACHE_CDN_TTL: "1800"
  CACHE_REDIS_TTL: "3600"
  CACHE_MEMORY_TTL: "600"
  CACHE_MEMORY_MAX_SIZE: "1000"
  CACHE_PRECACHING: "true"
  CACHE_POPULAR_THRESHOLD: "10"
  CACHE_CDN_ENABLED: "false"
  
  # Thread pool configuration
  THREAD_POOL_MAX_WORKERS: "10"
  THREAD_POOL_AUTO_SIZE: "true"
  
  # Session configuration
  SESSION_TTL: "86400"
  SESSION_COOKIE_NAME: "session_id"
  SESSION_COOKIE_SECURE: "true"
  SESSION_COOKIE_HTTPONLY: "true"
  SESSION_COOKIE_SAMESITE: "Lax"
  
  # Logging configuration
  LOG_LEVEL: "INFO"
  LOG_FORMAT: "json"
  LOG_TO_FILE: "true"
  LOG_FILE_PATH: "/app/logs/app.log"
  
  # Monitoring configuration
  METRICS_ENABLED: "true"
  METRICS_PORT: "5000"
  METRICS_PATH: "/api/metrics"
